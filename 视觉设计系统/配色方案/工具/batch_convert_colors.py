#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æ‰¹é‡æ”¹é€ è‰²å½©æ–‡ä»¶è„šæœ¬
å°†ç®€å•çš„é¢œè‰²ä»£ç æ–‡ä»¶è½¬æ¢ä¸ºæ ‡å‡†çš„ Markdown æ ¼å¼
"""

import os
import re
import glob
from typing import List, Tuple, Dict

# é¢„å®šä¹‰çš„è‰²å½©ä¸»é¢˜å’Œé£æ ¼
COLOR_THEMES = {
    3: {
        "name": "æ¸©æš–ç²‰æ©˜è‰²å½©ä½“ç³»",
        "style": "æ¸©æš–èˆ’é€‚ã€æµªæ¼«ä¼˜é›…",
        "features": "ä»¥ç²‰è‰²åˆ°æ©˜è‰²çš„æ¸å˜è‰²ç³»ä¸ºä¸»å¯¼ï¼Œæ­é…æ·±ç´«ç°è‰²ä½œä¸ºç¨³å®šåŸºè°ƒ",
        "scenes": "ç¾å¦†æ—¶å°šã€ç”Ÿæ´»æ–¹å¼ã€å¥³æ€§å‘åº”ç”¨ã€è‰ºæœ¯åˆ›ä½œå¹³å°",
        "concept": "è¥é€ æ¸©é¦¨æµªæ¼«ã€ä¼˜é›…ç²¾è‡´çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["çŠç‘šç²‰", "èœœæ¡ƒæ©˜", "ç«ç‘°ç²‰", "ç´«ç°è‰²", "æ·±ç´«ç°"]
    },
    4: {
        "name": "å¤§åœ°æš–è‰²è‰²å½©ä½“ç³»", 
        "style": "è‡ªç„¶æ¸©æš–ã€ç°ä»£å¤å¤",
        "features": "ä»¥æ·±ç»¿åˆ°æš–æ©˜çš„å¤§åœ°è‰²ç³»ä¸ºä¸»å¯¼ï¼Œä½“ç°è‡ªç„¶ä¸æ¸©æš–çš„å®Œç¾ç»“åˆ",
        "scenes": "æˆ·å¤–è¿åŠ¨ã€æ—…è¡Œåº”ç”¨ã€ç¾é£Ÿé¤é¥®ã€ç”Ÿæ´»æœåŠ¡ã€ç¯ä¿ä¸»é¢˜",
        "concept": "è¥é€ è‡ªç„¶äº²å’Œã€æ¸©æš–å¯é çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æ·±æ£®ç»¿", "ç¿¡ç¿ ç»¿", "é‡‘é»„è‰²", "æš–æ©˜è‰²", "çŠç‘šæ©˜"]
    },
    5: {
        "name": "ç´«è‰²æ¢¦å¹»è‰²å½©ä½“ç³»",
        "style": "ç¥ç§˜ä¼˜é›…ã€ç°ä»£æ—¶å°š", 
        "features": "ä»¥ç´«è‰²ç³»ä¸ºä¸»å¯¼ï¼Œä»æµ…ç´«åˆ°æ·±ç´«çš„æ¸å˜ï¼Œä½“ç°ç¥ç§˜ä¸ä¼˜é›…",
        "scenes": "åˆ›æ„è®¾è®¡ã€éŸ³ä¹å¨±ä¹ã€é«˜ç«¯å“ç‰Œã€è‰ºæœ¯å¹³å°ã€å¤œé—´æ¨¡å¼",
        "concept": "è¥é€ ç¥ç§˜ä¼˜é›…ã€å¯Œæœ‰åˆ›æ„çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æµ…è–°è¡£è‰", "ä¸­ç´«è‰²", "æ·±ç´«è‰²", "ç´«ç°è‰²", "æ·±ç´«ç°"]
    },
    6: {
        "name": "æ´»åŠ›æ©™è‰²è‰²å½©ä½“ç³»",
        "style": "æ´»åŠ›å››å°„ã€é’æ˜¥åŠ¨æ„Ÿ",
        "features": "ä»¥æ©™è‰²ç³»ä¸ºä¸»å¯¼ï¼Œä»æµ…æ©™åˆ°æ·±æ©™çš„æ´»åŠ›é…è‰²",
        "scenes": "è¿åŠ¨å¥èº«ã€é’å°‘å¹´åº”ç”¨ã€æ¸¸æˆå¨±ä¹ã€ç¤¾äº¤å¹³å°ã€æ´»åŠ¨æ¨å¹¿",
        "concept": "è¥é€ å……æ»¡æ´»åŠ›ã€ç§¯æå‘ä¸Šçš„ç”¨æˆ·ä½“éªŒ", 
        "colors": ["æµ…æ©™è‰²", "äº®æ©™è‰²", "æ·±æ©™è‰²", "æ©™çº¢è‰²", "æ·±çº¢æ©™"]
    },
    7: {
        "name": "æ¸…æ–°è“ç»¿è‰²å½©ä½“ç³»",
        "style": "æ¸…æ–°è‡ªç„¶ã€ç°ä»£ç®€çº¦",
        "features": "ä»¥è“ç»¿è‰²ç³»ä¸ºä¸»å¯¼ï¼Œä½“ç°æ¸…æ–°ä¸è‡ªç„¶çš„å’Œè°ç»Ÿä¸€",
        "scenes": "å¥åº·åŒ»ç–—ã€ç¯ä¿ç§‘æŠ€ã€æ•™è‚²å­¦ä¹ ã€åŠå…¬æ•ˆç‡ã€æ¸…æ–°ä¸»é¢˜",
        "concept": "è¥é€ æ¸…æ–°è‡ªç„¶ã€ä¸“ä¸šå¯ä¿¡çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["å¤©ç©ºè“", "é’ç»¿è‰²", "è–„è·ç»¿", "æµ…ç»¿è‰²", "æ·±ç»¿è‰²"]
    },
    8: {
        "name": "ç»å…¸è“è‰²è‰²å½©ä½“ç³»", 
        "style": "ä¸“ä¸šç¨³é‡ã€ç»å…¸æ°¸æ’",
        "features": "ä»¥è“è‰²ç³»ä¸ºä¸»å¯¼ï¼Œä»æµ…è“åˆ°æ·±è“çš„ç»å…¸é…è‰²",
        "scenes": "å•†åŠ¡åŠå…¬ã€é‡‘èæœåŠ¡ã€ä¼ä¸šåº”ç”¨ã€ä¸“ä¸šå·¥å…·ã€æ­£å¼åœºåˆ",
        "concept": "è¥é€ ä¸“ä¸šå¯ä¿¡ã€ç¨³é‡å¤§æ°”çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æµ…å¤©è“", "æ ‡å‡†è“", "æ·±è“è‰²", "æµ·å†›è“", "æ·±æµ·è“"]
    },
    9: {
        "name": "æ£®æ—ç»¿è‰²è‰²å½©ä½“ç³»",
        "style": "è‡ªç„¶ç”Ÿæ€ã€å¥åº·ç¯ä¿", 
        "features": "ä»¥ç»¿è‰²ç³»ä¸ºä¸»å¯¼ï¼Œä½“ç°è‡ªç„¶ç”Ÿæ€ä¸å¥åº·ç¯ä¿ç†å¿µ",
        "scenes": "ç¯ä¿åº”ç”¨ã€å¥åº·ç”Ÿæ´»ã€æˆ·å¤–è¿åŠ¨ã€å†œä¸šç§‘æŠ€ã€è‡ªç„¶ä¸»é¢˜",
        "concept": "è¥é€ è‡ªç„¶å¥åº·ã€ç”Ÿæœºå‹ƒå‹ƒçš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æµ…ç»¿è‰²", "è‰ç»¿è‰²", "æ£®æ—ç»¿", "æ·±ç»¿è‰²", "å¢¨ç»¿è‰²"]
    },
    10: {
        "name": "æš–è‰²è°ƒè‰²å½©ä½“ç³»",
        "style": "æ¸©æš–èˆ’é€‚ã€äº²å’Œå‹å¥½",
        "features": "ä»¥æš–è‰²è°ƒä¸ºä¸»å¯¼ï¼Œè¥é€ æ¸©é¦¨èˆ’é€‚çš„è§†è§‰æ„Ÿå—",
        "scenes": "å®¶å±…ç”Ÿæ´»ã€äº²å­åº”ç”¨ã€ç¤¾åŒºæœåŠ¡ã€æ¸©é¦¨ä¸»é¢˜ã€èˆ’é€‚ä½“éªŒ",
        "concept": "è¥é€ æ¸©æš–äº²å’Œã€èˆ’é€‚å®œäººçš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æš–é»„è‰²", "æ©™é»„è‰²", "æš–æ©˜è‰²", "æµ…æ£•è‰²", "æ·±æ£•è‰²"]
    },
    11: {
        "name": "æš–æ©˜ç´«è‰²å½©ä½“ç³»",
        "style": "æ¸©æš–ç¥ç§˜ã€æ—¶å°šä¸ªæ€§",
        "features": "ä»¥æš–æ©˜è‰²åˆ°æ·±ç´«è‰²çš„æ¸å˜ä¸ºä¸»å¯¼ï¼Œè¥é€ æ¸©æš–ä¸­å¸¦æœ‰ç¥ç§˜æ„Ÿçš„ç‹¬ç‰¹æ°›å›´",
        "scenes": "æ—¶å°šå“ç‰Œã€è‰ºæœ¯è®¾è®¡ã€ä¸ªæ€§åŒ–åº”ç”¨ã€åˆ›æ„å·¥ä½œå®¤ã€é«˜ç«¯å®šåˆ¶",
        "concept": "è¥é€ æ¸©æš–è€Œç¥ç§˜ã€æ—¶å°šä¸”ä¸ªæ€§çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æš–æ©˜è‰²", "çŠç‘šçº¢", "æ·±ç´«è‰²", "æ·±è“ç´«", "ç´«ç°è‰²"]
    },
    12: {
        "name": "æç®€ä¸­æ€§è‰²å½©ä½“ç³»",
        "style": "æç®€çº¯å‡€ã€ç°ä»£ç®€çº¦",
        "features": "ä»¥æ¥è¿‘ç™½è‰²çš„ææµ…è‰²è°ƒä¸ºä¸»å¯¼ï¼Œä½“ç°æç®€ä¸»ä¹‰çš„çº¯å‡€ç¾å­¦",
        "scenes": "æç®€è®¾è®¡ã€é«˜ç«¯å“ç‰Œã€è‰ºæœ¯å±•ç¤ºã€å»ºç­‘è®¾è®¡ã€ç®€çº¦ç”Ÿæ´»",
        "concept": "è¥é€ çº¯å‡€ç®€çº¦ã€é«˜é›…è„±ä¿—çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["è±¡ç‰™ç™½", "æµ…ç°ç™½", "ä¸­æ€§ç°", "æ·±ç°è‰²", "ç‚­ç°è‰²"]
    },
    13: {
        "name": "æ·±é‚ƒå¤œè‰²è‰²å½©ä½“ç³»",
        "style": "æ·±é‚ƒç¥ç§˜ã€é«˜ç«¯å¥¢å",
        "features": "ä»¥æ·±è‰²è°ƒä¸ºä¸»å¯¼ï¼Œè¥é€ ç¥ç§˜é«˜ç«¯çš„å¤œé—´æ°›å›´",
        "scenes": "å¤œé—´æ¨¡å¼ã€é«˜ç«¯åº”ç”¨ã€å¥¢ä¾ˆå“ç‰Œã€ä¸“ä¸šå·¥å…·ã€æš—è‰²ä¸»é¢˜",
        "concept": "è¥é€ æ·±é‚ƒç¥ç§˜ã€é«˜ç«¯ä¸“ä¸šçš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æ·±å¤œè“", "æš—ç´«è‰²", "æ·±ç°è‰²", "ç‚­é»‘è‰²", "çº¯é»‘è‰²"]
    },
    14: {
        "name": "æŸ”å’Œç²‰å½©è‰²å½©ä½“ç³»",
        "style": "æŸ”å’Œç”œç¾ã€æ¸…æ–°å¯çˆ±",
        "features": "ä»¥æŸ”å’Œçš„ç²‰å½©è‰²è°ƒä¸ºä¸»å¯¼ï¼Œè¥é€ ç”œç¾æ¸…æ–°çš„è§†è§‰æ„Ÿå—",
        "scenes": "å„¿ç«¥åº”ç”¨ã€å¥³æ€§äº§å“ã€ç”œå“ç¾é£Ÿã€å©šåº†æœåŠ¡ã€æ¸©é¦¨ç”Ÿæ´»",
        "concept": "è¥é€ æŸ”å’Œç”œç¾ã€æ¸…æ–°å¯çˆ±çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["ç²‰å«©è‰²", "æµ…ç²‰è‰²", "æŸ”å’Œè‰²", "æ·¡å½©è‰²", "æ¸©æŸ”è‰²"]
    },
    15: {
        "name": "æ´»åŠ›å½©è™¹è‰²å½©ä½“ç³»",
        "style": "æ´»åŠ›å››å°„ã€å¤šå½©ç¼¤çº·",
        "features": "ä»¥å¤šå½©æ˜äº®çš„è‰²è°ƒç»„åˆä¸ºä¸»å¯¼ï¼Œå±•ç°æ´»åŠ›ä¸åˆ›æ„",
        "scenes": "å„¿ç«¥æ•™è‚²ã€åˆ›æ„è®¾è®¡ã€å¨±ä¹æ¸¸æˆã€è‰ºæœ¯åˆ›ä½œã€æ´»åŠ¨åº†å…¸",
        "concept": "è¥é€ æ´»åŠ›å››å°„ã€åˆ›æ„æ— é™çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["æ˜äº®è‰²", "æ´»åŠ›è‰²", "å½©è™¹è‰²", "é²œè‰³è‰²", "åŠ¨æ„Ÿè‰²"]
    },
    16: {
        "name": "å•†åŠ¡ä¸“ä¸šè‰²å½©ä½“ç³»",
        "style": "å•†åŠ¡ä¸“ä¸šã€ç¨³é‡å¯ä¿¡",
        "features": "ä»¥å•†åŠ¡è‰²è°ƒä¸ºä¸»å¯¼ï¼Œä½“ç°ä¸“ä¸šæ€§å’Œå¯ä¿¡åº¦",
        "scenes": "å•†åŠ¡åŠå…¬ã€ä¼ä¸šåº”ç”¨ã€é‡‘èæœåŠ¡ã€ä¸“ä¸šå’¨è¯¢ã€æ­£å¼åœºåˆ",
        "concept": "è¥é€ å•†åŠ¡ä¸“ä¸šã€ç¨³é‡å¯ä¿¡çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["å•†åŠ¡è“", "ä¸“ä¸šç°", "ç¨³é‡è‰²", "æ­£å¼è‰²", "æƒå¨è‰²"]
    },
    17: {
        "name": "è‡ªç„¶å¤§åœ°è‰²å½©ä½“ç³»",
        "style": "è‡ªç„¶æœ´å®ã€å¤§åœ°æ°”æ¯",
        "features": "ä»¥å¤§åœ°è‰²è°ƒä¸ºä¸»å¯¼ï¼Œä½“ç°è‡ªç„¶æœ´å®çš„ç”Ÿæ€ç¾å­¦",
        "scenes": "ç¯ä¿åº”ç”¨ã€è‡ªç„¶ä¸»é¢˜ã€æˆ·å¤–è¿åŠ¨ã€å†œä¸šç§‘æŠ€ã€ç”Ÿæ€è®¾è®¡",
        "concept": "è¥é€ è‡ªç„¶æœ´å®ã€ç”Ÿæ€å’Œè°çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["å¤§åœ°è‰²", "åœŸå£¤è‰²", "å²©çŸ³è‰²", "æ ‘æœ¨è‰²", "è‡ªç„¶è‰²"]
    },
    18: {
        "name": "ç§‘æŠ€æœªæ¥è‰²å½©ä½“ç³»",
        "style": "ç§‘æŠ€å‰å«ã€æœªæ¥æ„Ÿå¼º",
        "features": "ä»¥ç§‘æŠ€è‰²è°ƒä¸ºä¸»å¯¼ï¼Œè¥é€ æœªæ¥æ„Ÿå’Œç§‘æŠ€æ„Ÿ",
        "scenes": "ç§‘æŠ€äº§å“ã€AIåº”ç”¨ã€æœªæ¥è®¾è®¡ã€æ•°å­—åŒ–å·¥å…·ã€åˆ›æ–°ç§‘æŠ€",
        "concept": "è¥é€ ç§‘æŠ€å‰å«ã€å……æ»¡æœªæ¥æ„Ÿçš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["ç§‘æŠ€è“", "ç”µå…‰è‰²", "é‡‘å±è‰²", "æœªæ¥è‰²", "æ•°å­—è‰²"]
    },
    19: {
        "name": "å¤å¤æ€€æ—§è‰²å½©ä½“ç³»",
        "style": "å¤å¤æ€€æ—§ã€ç»å…¸æ°¸æ’",
        "features": "ä»¥å¤å¤è‰²è°ƒä¸ºä¸»å¯¼ï¼Œè¥é€ æ€€æ—§ç»å…¸çš„æ—¶ä»£æ„Ÿ",
        "scenes": "å¤å¤è®¾è®¡ã€æ€€æ—§ä¸»é¢˜ã€ç»å…¸å“ç‰Œã€æ–‡åŒ–ä¼ æ‰¿ã€æ—¶ä»£å›å¿†",
        "concept": "è¥é€ å¤å¤æ€€æ—§ã€ç»å…¸æ°¸æ’çš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["å¤å¤è‰²", "æ€€æ—§è‰²", "ç»å…¸è‰²", "æ—¶ä»£è‰²", "ä¼ ç»Ÿè‰²"]
    },
    20: {
        "name": "å¥¢åé‡‘å±è‰²å½©ä½“ç³»",
        "style": "å¥¢åé«˜è´µã€é‡‘å±è´¨æ„Ÿ",
        "features": "ä»¥é‡‘å±è‰²è°ƒä¸ºä¸»å¯¼ï¼Œè¥é€ å¥¢åé«˜è´µçš„è´¨æ„Ÿä½“éªŒ",
        "scenes": "å¥¢ä¾ˆå“ç‰Œã€é«˜ç«¯äº§å“ã€ç å®é¦–é¥°ã€è±ªåæœåŠ¡ã€å°Šè´µä½“éªŒ",
        "concept": "è¥é€ å¥¢åé«˜è´µã€é‡‘å±è´¨æ„Ÿçš„ç”¨æˆ·ä½“éªŒ",
        "colors": ["é‡‘è‰²", "é“¶è‰²", "é“œè‰²", "é“‚é‡‘è‰²", "é’›é‡‘è‰²"]
    }
}

def parse_color_file(file_path: str) -> Tuple[List[str], List[str]]:
    """è§£æé¢œè‰²æ–‡ä»¶ï¼Œæå–HEXå’ŒRGBå€¼"""
    hex_colors = []
    rgb_colors = []
    
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # æå–HEXé¢œè‰²
    hex_pattern = r'#[A-Fa-f0-9]{6}'
    hex_matches = re.findall(hex_pattern, content)
    hex_colors = hex_matches[:5]  # åªå–å‰5ä¸ª
    
    # æå–RGBé¢œè‰²
    rgb_pattern = r'rgb\(\s*(\d+),\s*(\d+),\s*(\d+)\s*\)'
    rgb_matches = re.findall(rgb_pattern, content)
    rgb_colors = [f"rgb({r}, {g}, {b})" for r, g, b in rgb_matches[:5]]
    
    return hex_colors, rgb_colors

def get_color_characteristics(hex_color: str, color_name: str) -> Dict[str, str]:
    """æ ¹æ®é¢œè‰²ç”Ÿæˆç‰¹æ€§æè¿°"""
    # ç®€åŒ–çš„é¢œè‰²ç‰¹æ€§æ˜ å°„
    color_traits = {
        "ç²‰": {"traits": "æ¸©æŸ”ã€æµªæ¼«ã€äº²å’Œ", "emotion": "æ¸©é¦¨ã€ç”œç¾ã€èˆ’é€‚"},
        "æ©˜": {"traits": "æ´»åŠ›ã€æ¸©æš–ã€å‹å¥½", "emotion": "çƒ­æƒ…ã€ç§¯æã€æ„‰æ‚¦"},
        "çº¢": {"traits": "çƒ­æƒ…ã€é†’ç›®ã€å¼ºçƒˆ", "emotion": "æ¿€æƒ…ã€åŠ›é‡ã€é‡è¦"},
        "é»„": {"traits": "æ˜äº®ã€æ´»æ³¼ã€æ¸©æš–", "emotion": "å¿«ä¹ã€å¸Œæœ›ã€æ´»åŠ›"},
        "ç»¿": {"traits": "è‡ªç„¶ã€å¹³å’Œã€æ¸…æ–°", "emotion": "å®‰å…¨ã€æˆé•¿ã€å’Œè°"},
        "è“": {"traits": "å†·é™ã€ä¸“ä¸šã€å¯ä¿¡", "emotion": "å®‰å…¨ã€ç¨³å®šã€ç†æ€§"},
        "ç´«": {"traits": "ç¥ç§˜ã€ä¼˜é›…ã€åˆ›æ„", "emotion": "é«˜è´µã€æƒ³è±¡ã€ç¥ç§˜"},
        "ç°": {"traits": "ä¸­æ€§ã€ç¨³é‡ã€å¹³è¡¡", "emotion": "æ²‰ç¨³ã€ä¸“ä¸šã€ä½è°ƒ"},
        "æ£•": {"traits": "ç¨³é‡ã€è‡ªç„¶ã€æ¸©æš–", "emotion": "å¯é ã€èˆ’é€‚ã€ä¼ ç»Ÿ"}
    }
    
    # æ ¹æ®é¢œè‰²åç§°åŒ¹é…ç‰¹æ€§
    for key, traits in color_traits.items():
        if key in color_name:
            return traits
    
    # é»˜è®¤ç‰¹æ€§
    return {"traits": "å¹³è¡¡ã€å’Œè°ã€é€‚ä¸­", "emotion": "èˆ’é€‚ã€è‡ªç„¶ã€ç¨³å®š"}

def generate_markdown_content(file_num: int, hex_colors: List[str], rgb_colors: List[str]) -> str:
    """ç”ŸæˆMarkdownå†…å®¹"""
    
    if file_num not in COLOR_THEMES:
        # ç”Ÿæˆé»˜è®¤ä¸»é¢˜
        theme = {
            "name": f"é…è‰²æ–¹æ¡ˆ{file_num}",
            "style": "ç°ä»£ç®€çº¦ã€å¹³è¡¡å’Œè°",
            "features": "ç²¾å¿ƒæ­é…çš„è‰²å½©ç»„åˆï¼Œä½“ç°ç°ä»£è®¾è®¡ç¾å­¦",
            "scenes": "é€šç”¨åº”ç”¨ã€ç°ä»£ç•Œé¢ã€ç®€çº¦è®¾è®¡",
            "concept": "è¥é€ å’Œè°ç»Ÿä¸€ã€ç°ä»£ç®€çº¦çš„ç”¨æˆ·ä½“éªŒ",
            "colors": [f"é¢œè‰²{i+1}" for i in range(5)]
        }
    else:
        theme = COLOR_THEMES[file_num]
    
    # ç¡®ä¿æœ‰5ä¸ªé¢œè‰²
    while len(hex_colors) < 5:
        hex_colors.append("#CCCCCC")
    while len(rgb_colors) < 5:
        rgb_colors.append("rgb(204, 204, 204)")
    while len(theme["colors"]) < 5:
        theme["colors"].append(f"é¢œè‰²{len(theme['colors'])+1}")
    
    markdown_content = f"""# {theme["name"]} - æ ¸å¿ƒ5è‰²é…è‰²æ–¹æ¡ˆ

## è®¾è®¡é£æ ¼æè¿°

- **æ•´ä½“é£æ ¼**ï¼š{theme["style"]}
- **è‰²å½©ç‰¹ç‚¹**ï¼š{theme["features"]}
- **é€‚ç”¨åœºæ™¯**ï¼š{theme["scenes"]}
- **è®¾è®¡ç†å¿µ**ï¼š{theme["concept"]}

## æ ¸å¿ƒè‰²å½©ä½“ç³»ï¼ˆ5è‰²ï¼‰

### 1. ä¸»è‰²è°ƒï¼ˆPrimary Colorï¼‰- {theme["colors"][0]}

- **è¯´æ˜**ï¼šåº”ç”¨ä¸­æœ€æ ¸å¿ƒã€å‡ºç°é¢‘ç‡æœ€é«˜çš„é¢œè‰²ï¼Œä»£è¡¨å“ç‰Œå½¢è±¡
- **HEX**ï¼š`{hex_colors[0]}`
- **RGB**ï¼š`{rgb_colors[0]}`
- **è‰²å½©ç‰¹æ€§**ï¼š{get_color_characteristics(hex_colors[0], theme["colors"][0])["traits"]}
- **æƒ…æ„Ÿè¡¨è¾¾**ï¼š{get_color_characteristics(hex_colors[0], theme["colors"][0])["emotion"]}
- **åº”ç”¨åœºæ™¯**ï¼šä¸»å¯¼èˆªæ ã€é‡è¦æŒ‰é’®ã€å“ç‰Œæ ‡è¯†ã€ä¸»æ ‡é¢˜

### 2. è¾…åŠ©è‰²ï¼ˆSecondary Colorï¼‰- {theme["colors"][1]}

- **è¯´æ˜**ï¼šé…åˆä¸»è‰²è°ƒä½¿ç”¨ï¼Œç”¨äºå¼ºè°ƒæ¬¡è¦äº¤äº’å…ƒç´ 
- **HEX**ï¼š`{hex_colors[1]}`
- **RGB**ï¼š`{rgb_colors[1]}`
- **è‰²å½©ç‰¹æ€§**ï¼š{get_color_characteristics(hex_colors[1], theme["colors"][1])["traits"]}
- **æƒ…æ„Ÿè¡¨è¾¾**ï¼š{get_color_characteristics(hex_colors[1], theme["colors"][1])["emotion"]}
- **åº”ç”¨åœºæ™¯**ï¼šæ¬¡è¦æŒ‰é’®ã€æ ‡ç­¾é¡µã€è¿›åº¦æ¡ã€å›¾æ ‡

### 3. å¼ºè°ƒè‰²ï¼ˆAccent Colorï¼‰- {theme["colors"][2]}

- **è¯´æ˜**ï¼šç”¨äºçªå‡ºå…³é”®ä¿¡æ¯æˆ–å¼•å¯¼ç”¨æˆ·æ³¨æ„çš„é¢œè‰²
- **HEX**ï¼š`{hex_colors[2]}`
- **RGB**ï¼š`{rgb_colors[2]}`
- **è‰²å½©ç‰¹æ€§**ï¼š{get_color_characteristics(hex_colors[2], theme["colors"][2])["traits"]}
- **æƒ…æ„Ÿè¡¨è¾¾**ï¼š{get_color_characteristics(hex_colors[2], theme["colors"][2])["emotion"]}
- **åº”ç”¨åœºæ™¯**ï¼šé‡è¦é€šçŸ¥ã€çŠ¶æ€æç¤ºã€ç‰¹æ®ŠæŒ‰é’®ã€å¼ºè°ƒå…ƒç´ 

### 4. ä¸­æ€§è‰²1ï¼ˆNeutral - Lightï¼‰- {theme["colors"][3]}

- **è¯´æ˜**ï¼šåæµ…çš„ä¸­æ€§è‰²ï¼Œç”¨äºèƒŒæ™¯ã€åˆ†å‰²çº¿ã€æ¬¡è¦æ–‡æœ¬ç­‰
- **HEX**ï¼š`{hex_colors[3]}`
- **RGB**ï¼š`{rgb_colors[3]}`
- **è‰²å½©ç‰¹æ€§**ï¼š{get_color_characteristics(hex_colors[3], theme["colors"][3])["traits"]}
- **æƒ…æ„Ÿè¡¨è¾¾**ï¼š{get_color_characteristics(hex_colors[3], theme["colors"][3])["emotion"]}
- **åº”ç”¨åœºæ™¯**ï¼šé¡µé¢èƒŒæ™¯ã€å¡ç‰‡èƒŒæ™¯ã€è¾“å…¥æ¡†èƒŒæ™¯ã€æµ…è‰²åˆ†å‰²çº¿

### 5. ä¸­æ€§è‰²2ï¼ˆNeutral - Darkï¼‰- {theme["colors"][4]}

- **è¯´æ˜**ï¼šåæ·±çš„ä¸­æ€§è‰²ï¼Œç”¨äºä¸»è¦æ–‡æœ¬ã€å›¾æ ‡ã€è¾¹æ¡†ç­‰
- **HEX**ï¼š`{hex_colors[4]}`
- **RGB**ï¼š`{rgb_colors[4]}`
- **è‰²å½©ç‰¹æ€§**ï¼š{get_color_characteristics(hex_colors[4], theme["colors"][4])["traits"]}
- **æƒ…æ„Ÿè¡¨è¾¾**ï¼š{get_color_characteristics(hex_colors[4], theme["colors"][4])["emotion"]}
- **åº”ç”¨åœºæ™¯**ï¼šä¸»è¦æ–‡å­—ã€å›¾æ ‡ã€è¾¹æ¡†ã€æ¬¡è¦ä¿¡æ¯æ–‡æœ¬"""
    
    return markdown_content

def add_remaining_sections(content: str, hex_colors: List[str]) -> str:
    """æ·»åŠ å‰©ä½™çš„æ ‡å‡†ç« èŠ‚"""
    
    remaining_sections = f"""
## è‰²å½©æ­é…ç¤ºä¾‹ä¸åº”ç”¨åœºæ™¯

### ä¸»è¦é…è‰²ç»„åˆç¤ºä¾‹

#### 1. ä¸»å¯¼é…è‰²ï¼ˆPrimary Combinationï¼‰
- **ç»„åˆ**ï¼šä¸»è‰² + è¾…åŠ©è‰²ï¼š`{hex_colors[0]}` + `{hex_colors[1]}`
- **æ•ˆæœ**ï¼šä¸“ä¸šåè°ƒï¼Œå±‚æ¬¡åˆ†æ˜ï¼Œé€‚åˆä¸»è¦åŠŸèƒ½åŒºåŸŸ
- **ç¤ºä¾‹**ï¼šå¯¼èˆªæ ã€ä¸»è¦æŒ‰é’®ç»„ã€æ ‡é¢˜åŒºåŸŸ

#### 2. å¯¹æ¯”é…è‰²ï¼ˆContrast Combinationï¼‰
- **ç»„åˆ**ï¼šä¸»è‰² + å¼ºè°ƒè‰²ï¼š`{hex_colors[0]}` + `{hex_colors[2]}`
- **æ•ˆæœ**ï¼šå¼ºçƒˆå¯¹æ¯”ï¼Œçªå‡ºé‡è¦ä¿¡æ¯ï¼Œå¼•å¯¼ç”¨æˆ·æ“ä½œ
- **ç¤ºä¾‹**ï¼šé‡è¦é€šçŸ¥ã€CTAæŒ‰é’®ã€çŠ¶æ€æç¤º

#### 3. å’Œè°é…è‰²ï¼ˆHarmonious Combinationï¼‰
- **ç»„åˆ**ï¼šè¾…åŠ©è‰² + ä¸­æ€§è‰²ï¼š`{hex_colors[1]}` + `{hex_colors[3]}`
- **æ•ˆæœ**ï¼šæŸ”å’Œè‡ªç„¶ï¼Œèˆ’é€‚é˜…è¯»ï¼Œé€‚åˆå†…å®¹å±•ç¤º
- **ç¤ºä¾‹**ï¼šå†…å®¹åŒºåŸŸã€å¡ç‰‡è®¾è®¡ã€è¡¨å•å…ƒç´ 

#### 4. å¹³è¡¡é…è‰²ï¼ˆBalanced Combinationï¼‰
- **ç»„åˆ**ï¼šå¼ºè°ƒè‰² + ä¸­æ€§è‰²ï¼š`{hex_colors[2]}` + `{hex_colors[4]}`
- **æ•ˆæœ**ï¼šå¹³è¡¡ç¨³å®šï¼Œæ—¢æœ‰é‡ç‚¹åˆä¸å¤±å’Œè°
- **ç¤ºä¾‹**ï¼šä¿¡æ¯å±•ç¤ºã€æ•°æ®å¯è§†åŒ–ã€çŠ¶æ€æŒ‡ç¤º

### ç•Œé¢å…ƒç´ é…è‰²ç¤ºä¾‹

#### æŒ‰é’®è®¾è®¡
- **ä¸»è¦æŒ‰é’®**ï¼šèƒŒæ™¯ `{hex_colors[0]}`ï¼Œæ–‡å­— `#FFFFFF`
- **æ¬¡è¦æŒ‰é’®**ï¼šèƒŒæ™¯ `{hex_colors[1]}`ï¼Œæ–‡å­— `#FFFFFF`
- **å¼ºè°ƒæŒ‰é’®**ï¼šèƒŒæ™¯ `{hex_colors[2]}`ï¼Œæ–‡å­— `#FFFFFF`
- **ç¦ç”¨æŒ‰é’®**ï¼šèƒŒæ™¯ `{hex_colors[4]}`ï¼Œæ–‡å­— `#FFFFFF`

#### æ–‡å­—å±‚çº§
- **ä¸»æ ‡é¢˜**ï¼š`{hex_colors[0]}`
- **å‰¯æ ‡é¢˜**ï¼š`{hex_colors[1]}`
- **æ­£æ–‡**ï¼š`#666666`ï¼ˆæ·±ç°ï¼‰
- **æ¬¡è¦æ–‡å­—**ï¼š`{hex_colors[4]}`
- **æç¤ºæ–‡å­—**ï¼š`#999999`ï¼ˆæµ…ç°ï¼‰

#### çŠ¶æ€æŒ‡ç¤º
- **æˆåŠŸçŠ¶æ€**ï¼š`{hex_colors[1]}`
- **è­¦å‘ŠçŠ¶æ€**ï¼š`#FFB800`ï¼ˆæ©™é»„ï¼‰
- **é”™è¯¯çŠ¶æ€**ï¼š`#FF4757`ï¼ˆçº¢è‰²ï¼‰
- **ä¿¡æ¯çŠ¶æ€**ï¼š`{hex_colors[0]}`

## åŸå§‹é¢œè‰²ä»£ç å¿«é€Ÿå‚è€ƒ

### HEX ä»£ç 
```
{hex_colors[0]}  // ä¸»è‰²
{hex_colors[1]}  // è¾…åŠ©è‰²
{hex_colors[2]}  // å¼ºè°ƒè‰²
{hex_colors[3]}  // ä¸­æ€§æµ…è‰²
{hex_colors[4]}  // ä¸­æ€§æ·±è‰²
```

### RGB ä»£ç 
```
{', '.join([f'rgb({hex_colors[i][1:3]}, {hex_colors[i][3:5]}, {hex_colors[i][5:7]})' if len(hex_colors[i]) == 7 else 'rgb(204, 204, 204)' for i in range(5)])}
```

## æ— éšœç¢è®¾è®¡ä¸å¯¹æ¯”åº¦æŒ‡å—

### å¯¹æ¯”åº¦æ£€æŸ¥ï¼ˆWCAG 2.1 æ ‡å‡†ï¼‰
- ä¸»è‰² `{hex_colors[0]}` vs ç™½è‰²ï¼šå»ºè®®è¿›è¡Œå¯¹æ¯”åº¦æµ‹è¯•
- è¾…åŠ©è‰² `{hex_colors[1]}` vs ç™½è‰²ï¼šå»ºè®®è¿›è¡Œå¯¹æ¯”åº¦æµ‹è¯•
- å¼ºè°ƒè‰² `{hex_colors[2]}` vs ç™½è‰²ï¼šå»ºè®®è¿›è¡Œå¯¹æ¯”åº¦æµ‹è¯•
- ä¸­æ€§è‰² `{hex_colors[4]}` vs æ·±è‰²æ–‡å­—ï¼šå»ºè®®è¿›è¡Œå¯¹æ¯”åº¦æµ‹è¯•

### å»ºè®®æ–‡å­—æ­é…
- âœ… ç™½è‰²èƒŒæ™¯ + `{hex_colors[0]}` æ–‡å­—
- âœ… `{hex_colors[3]}` èƒŒæ™¯ + `{hex_colors[0]}` æ–‡å­—
- âœ… `{hex_colors[1]}` èƒŒæ™¯ + ç™½è‰²æ–‡å­—
- âœ… `{hex_colors[2]}` èƒŒæ™¯ + ç™½è‰²æ–‡å­—

## ä½¿ç”¨æŒ‡å—ä¸æœ€ä½³å®è·µ

### è‰²å½©ä½¿ç”¨åŸåˆ™

#### 1. 60-30-10 æ³•åˆ™
- **60%**ï¼šä¸­æ€§è‰²ä½œä¸ºä¸»è¦èƒŒæ™¯è‰²ï¼ˆ`{hex_colors[3]}`, ç™½è‰²ï¼‰
- **30%**ï¼šä¸»è‰²è°ƒä½œä¸ºæ¬¡è¦è‰²å½©ï¼ˆ`{hex_colors[0]}`ï¼‰
- **10%**ï¼šå¼ºè°ƒè‰²ä½œä¸ºç‚¹ç¼€è‰²ï¼ˆ`{hex_colors[2]}`, `{hex_colors[1]}`ï¼‰

#### 2. åŠŸèƒ½æ€§ç”¨è‰²
- **å¯¼èˆª**ï¼šä¸»è‰² `{hex_colors[0]}`
- **äº¤äº’**ï¼šè¾…åŠ©è‰² `{hex_colors[1]}`
- **å¼ºè°ƒ**ï¼šå¼ºè°ƒè‰² `{hex_colors[2]}`
- **èƒŒæ™¯**ï¼šä¸­æ€§è‰² `{hex_colors[3]}`

#### 3. æƒ…æ„ŸåŒ–è®¾è®¡
- **ä¸»è¦æƒ…æ„Ÿ**ï¼šé€šè¿‡ä¸»è‰² `{hex_colors[0]}` ä¼ è¾¾
- **è¾…åŠ©æƒ…æ„Ÿ**ï¼šé€šè¿‡è¾…åŠ©è‰² `{hex_colors[1]}` æ”¯æ’‘
- **é‡ç‚¹å¼ºè°ƒ**ï¼šé€‚åº¦ä½¿ç”¨å¼ºè°ƒè‰² `{hex_colors[2]}`

### é¿å…äº‹é¡¹
- âŒ ä¸è¦åœ¨å°é¢ç§¯ä½¿ç”¨è¿‡å¤šå¼ºè°ƒè‰²
- âŒ é¿å…ç›¸ä¼¼é¢œè‰²åœ¨ç›¸é‚»å…ƒç´ ä¸­ä½¿ç”¨
- âŒ ä¸è¦å¿½è§†è‰²ç›²ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒ
- âŒ é¿å…çº¯è‰²å¤§é¢ç§¯ä½¿ç”¨ï¼Œå»ºè®®åŠ å…¥é€æ˜åº¦

## æ‰©å±•è‰²å½©ï¼ˆå¯é€‰è¡¥å……è‰²ï¼‰

### åŸºäºä¸»è‰²ç³»çš„æ‰©å±•è‰²
- **ä¸»è‰²å˜ä½“**ï¼šåœ¨ `{hex_colors[0]}` åŸºç¡€ä¸Šè°ƒæ•´æ˜åº¦å’Œé¥±å’Œåº¦
- **è¾…åŠ©è‰²å˜ä½“**ï¼šåœ¨ `{hex_colors[1]}` åŸºç¡€ä¸Šåˆ›å»ºæ·±æµ…å˜åŒ–
- **å¼ºè°ƒè‰²å˜ä½“**ï¼šåœ¨ `{hex_colors[2]}` åŸºç¡€ä¸Šç”Ÿæˆç›¸è¿‘è‰²è°ƒ

### ç°åº¦ç³»ç»Ÿï¼ˆç”¨äºæ–‡å­—å’Œè¾¹æ¡†ï¼‰
- `#333333`ï¼ˆä¸»è¦æ–‡å­—ï¼‰
- `#666666`ï¼ˆæ¬¡è¦æ–‡å­—ï¼‰
- `#999999`ï¼ˆè¾…åŠ©æ–‡å­—ï¼‰
- `#CCCCCC`ï¼ˆè¾¹æ¡†çº¿ï¼‰
- `#F5F5F5`ï¼ˆæµ…è‰²èƒŒæ™¯ï¼‰

## CSS å˜é‡å®šä¹‰ç¤ºä¾‹

```css
:root {{
  /* ä¸»è‰²ç³» */
  --primary-color: {hex_colors[0]};
  --secondary-color: {hex_colors[1]};
  --accent-color: {hex_colors[2]};
  --neutral-light: {hex_colors[3]};
  --neutral-dark: {hex_colors[4]};

  /* åŠŸèƒ½è‰² */
  --success-color: var(--secondary-color);
  --warning-color: #FFB800;
  --error-color: #FF4757;
  --info-color: var(--primary-color);

  /* æ–‡å­—è‰² */
  --text-primary: #333333;
  --text-secondary: #666666;
  --text-tertiary: #999999;
  --text-disabled: #CCCCCC;

  /* èƒŒæ™¯è‰² */
  --bg-primary: #FFFFFF;
  --bg-secondary: var(--neutral-light);
  --bg-tertiary: #F5F5F5;
}}
```"""
    
    return content + remaining_sections

def convert_color_file(input_file: str, output_file: str, file_num: int):
    """è½¬æ¢å•ä¸ªé¢œè‰²æ–‡ä»¶"""
    try:
        # è§£æåŸå§‹æ–‡ä»¶
        hex_colors, rgb_colors = parse_color_file(input_file)
        
        if not hex_colors:
            print(f"è­¦å‘Š: {input_file} ä¸­æœªæ‰¾åˆ°æœ‰æ•ˆçš„é¢œè‰²ä»£ç ")
            return False
        
        # ç”ŸæˆMarkdownå†…å®¹
        content = generate_markdown_content(file_num, hex_colors, rgb_colors)
        content = add_remaining_sections(content, hex_colors)
        
        # å†™å…¥è¾“å‡ºæ–‡ä»¶
        with open(output_file, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"âœ… æˆåŠŸè½¬æ¢: {input_file} -> {output_file}")
        return True
        
    except Exception as e:
        print(f"âŒ è½¬æ¢å¤±è´¥ {input_file}: {str(e)}")
        return False

def main():
    """ä¸»å‡½æ•°"""
    print("ğŸ¨ å¼€å§‹æ‰¹é‡è½¬æ¢è‰²å½©æ–‡ä»¶...")

    # è·å–æ‰€æœ‰éœ€è¦è½¬æ¢çš„txtæ–‡ä»¶
    txt_files = glob.glob("æ­é…è‰²é¢œè‰²ä»£ç *.txt")
    txt_files.sort()
    
    success_count = 0
    total_count = len(txt_files)
    
    for txt_file in txt_files:
        # æå–æ–‡ä»¶ç¼–å·
        match = re.search(r'æ­é…è‰²é¢œè‰²ä»£ç (\d+)\.txt', txt_file)
        if not match:
            continue
            
        file_num = int(match.group(1))
        
        # ç”Ÿæˆè¾“å‡ºæ–‡ä»¶å
        output_file = txt_file.replace('.txt', '.md')
        
        # è½¬æ¢æ–‡ä»¶
        if convert_color_file(txt_file, output_file, file_num):
            success_count += 1
            # åˆ é™¤åŸå§‹txtæ–‡ä»¶
            try:
                os.remove(txt_file)
                print(f"ğŸ—‘ï¸  åˆ é™¤åŸæ–‡ä»¶: {txt_file}")
            except:
                print(f"âš ï¸  æ— æ³•åˆ é™¤åŸæ–‡ä»¶: {txt_file}")
    
    print(f"\nğŸ‰ æ‰¹é‡è½¬æ¢å®Œæˆ!")
    print(f"ğŸ“Š æˆåŠŸè½¬æ¢: {success_count}/{total_count} ä¸ªæ–‡ä»¶")
    print(f"ğŸ“ è¾“å‡ºç›®å½•: color/")

if __name__ == "__main__":
    main()
